<h1>Nueva Venta</h1>

<%= form_with model: @sale, local: true, class: "space-y-6" do |f| %>

  <div>
    <%= f.label :sold_at, "Fecha de venta" %>
    <%= f.date_field :sold_at, class: "border rounded p-2 w-full" %>
  </div>

  <div>
    <%= f.label :customer_name, "Cliente" %>
    <%= f.text_field :customer_name, class: "border rounded p-2 w-full" %>
  </div>

  <h2 class="text-lg font-bold">Items</h2>

  <div id="items-container" class="space-y-4">
    <%= f.fields_for :item_sales do |item_form| %>
      <%= render "item_fields", f: item_form %>
    <% end %>
  </div>

  <button type="button" id="add-item" class="bg-blue-600 text-white px-3 py-1 rounded">
    Agregar producto
  </button>

  <div id="item-template" class="hidden">
    <%= f.fields_for :item_sales, ItemSale.new, child_index: "NEW_RECORD" do |item_form| %>
      <%= render "item_fields", f: item_form %>
    <% end %>
  </div>

  <div>
    <%= f.label :total_amount, "Total" %>
    <%= f.number_field :total_amount, step: 0.01, class: "border rounded p-2 w-full" %>
  </div>

  <%= f.submit "Crear Venta", class: "bg-green-600 text-white px-4 py-2 rounded" %>

<% end %>