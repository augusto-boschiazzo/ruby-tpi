<h1>Nueva Venta</h1>

<% if @sale.errors.any? %>
  <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
    <h2 class="font-bold">Errores al crear la venta:</h2>
    <ul class="list-disc pl-5">
      <% @sale.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= form_with model: @sale, local: true, class: "space-y-6" do |f| %>

  <div>
    <%= f.label :client_dni, "DNI del cliente" %>
    <%= f.text_field :client_dni, class: "border rounded p-2 w-full" %>
  </div>

  <div>
    <%= f.label :client_name, "Nombre del cliente" %>
    <%= f.text_field :client_name, class: "border rounded p-2 w-full" %>
  </div>

  <h2 class="text-lg font-bold">Items</h2>

  <div id="items-container" class="space-y-4">
    <%= f.fields_for :item_sales do |item_form| %>
      <%= render "item_fields", f: item_form %>
    <% end %>
  </div>

  <button type="button" id="add-item" class="bg-blue-600 text-white px-3 py-1 rounded">
    Agregar producto
  </button>

  <div id="item-template" class="hidden">
    <%= f.fields_for :item_sales, ItemSale.new, child_index: "NEW_RECORD" do |item_form| %>
      <%= render "item_fields", f: item_form %>
    <% end %>
  </div>

  <%= f.submit "Crear Venta", class: "bg-green-600 text-white px-4 py-2 rounded" %>

<% end %>